CMAKE_MINIMUM_REQUIRED(VERSION 3.10.2)
PROJECT(airlaps)

OPTION(AIRLAPS_BUILD_TESTING OFF)

# SDK

SET(PYBIND11_VERSION "2.2.4")
ADD_SUBDIRECTORY(sdk/pybind11-${PYBIND11_VERSION})

SET(JSON_VERSION "3.2.0")
SET(JSON_INCLUDE_DIR ${CMAKE_SOURCE_DIR}/sdk/json-${JSON_VERSION}/single_include/nlohmann)
ADD_SUBDIRECTORY(sdk/json-${JSON_VERSION})

SET(PEGTL_VERSION "2.8.0")
SET(PEGTL_BUILD_TESTS OFF CACHE BOOL "disable PEGTL tests")
SET(PEGTL_BUILD_EXAMPLES OFF CACHE BOOL "disable PEGTL examples")
SET(PEGTL_INCLUDE_DIR ${CMAKE_SOURCE_DIR}/sdk/pegtl-${PEGTL_VERSION}/include/tao)
ADD_SUBDIRECTORY(sdk/PEGTL-${PEGTL_VERSION})

IF (AIRLAPS_BUILD_TESTING)
    SET(CATCH2_VERSION "2.4.0")
    SET(CATCH2_INCLUDE_DIR ${CMAKE_SOURCE_DIR}/sdk/Catch2-${CATCH2_VERSION}/single_include/catch2)
    ADD_SUBDIRECTORY(sdk/Catch2-${CATCH2_VERSION})
ENDIF()

OPTION(ONLY_PYTHON OFF)
OPTION(BUILD_PYTHON_BINDING ON)

# LIB
ADD_SUBDIRECTORY(src)


# TESTS
IF (AIRLAPS_BUILD_TESTING AND NOT ONLY_PYTHON)
    ENABLE_TESTING()  # leave it outside the 'tests' directory so ctest can find the CTestTestFile.cmake in the top build directory
    ADD_SUBDIRECTORY(tests)
ENDIF()